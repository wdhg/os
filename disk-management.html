<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Disk Management - Operating Systems</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="preface.html"><strong aria-hidden="true">1.</strong> Preface</a></li><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">2.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="processes.html"><strong aria-hidden="true">3.</strong> Processes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="processes/unix.html"><strong aria-hidden="true">3.1.</strong> UNIX Processes</a></li><li class="chapter-item expanded "><a href="processes/windows.html"><strong aria-hidden="true">3.2.</strong> Windows Processes</a></li><li class="chapter-item expanded "><a href="processes/communication.html"><strong aria-hidden="true">3.3.</strong> Process Communication</a></li></ol></li><li class="chapter-item expanded "><a href="threads.html"><strong aria-hidden="true">4.</strong> Threads</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="threads/posix.html"><strong aria-hidden="true">4.1.</strong> PThreads (POSIX Threads)</a></li><li class="chapter-item expanded "><a href="threads/user-kernel.html"><strong aria-hidden="true">4.2.</strong> User-Level and Kernel-Level Threads</a></li></ol></li><li class="chapter-item expanded "><a href="scheduling.html"><strong aria-hidden="true">5.</strong> Scheduling</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="scheduling/fcfs.html"><strong aria-hidden="true">5.1.</strong> First-Come First-Served</a></li><li class="chapter-item expanded "><a href="scheduling/rr.html"><strong aria-hidden="true">5.2.</strong> Round-Robin</a></li><li class="chapter-item expanded "><a href="scheduling/sjf-srt.html"><strong aria-hidden="true">5.3.</strong> Shortest Job First and Shortest Remaining Time</a></li><li class="chapter-item expanded "><a href="scheduling/fs.html"><strong aria-hidden="true">5.4.</strong> Fair-Share Scheduling</a></li><li class="chapter-item expanded "><a href="scheduling/priority.html"><strong aria-hidden="true">5.5.</strong> Priority Scheduling</a></li><li class="chapter-item expanded "><a href="scheduling/mlfqs.html"><strong aria-hidden="true">5.6.</strong> Multilevel Feedback Queues (MLFQS)</a></li><li class="chapter-item expanded "><a href="scheduling/lottery.html"><strong aria-hidden="true">5.7.</strong> Lottery Scheduling</a></li></ol></li><li class="chapter-item expanded "><a href="synchronisation.html"><strong aria-hidden="true">6.</strong> Synchronisation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="synchronisation/mutual-exclusion.html"><strong aria-hidden="true">6.1.</strong> Attempts at Gaining Mutual Exclusion</a></li><li class="chapter-item expanded "><a href="synchronisation/atomics.html"><strong aria-hidden="true">6.2.</strong> Atomic Operations</a></li><li class="chapter-item expanded "><a href="synchronisation/locks.html"><strong aria-hidden="true">6.3.</strong> Locks</a></li><li class="chapter-item expanded "><a href="synchronisation/race-conditions.html"><strong aria-hidden="true">6.4.</strong> Race Conditions and Memory Models</a></li><li class="chapter-item expanded "><a href="synchronisation/semaphores.html"><strong aria-hidden="true">6.5.</strong> Semaphores</a></li><li class="chapter-item expanded "><a href="synchronisation/monitors.html"><strong aria-hidden="true">6.6.</strong> Monitors</a></li><li class="chapter-item expanded "><a href="synchronisation/deadlocks.html"><strong aria-hidden="true">6.7.</strong> Deadlocks</a></li></ol></li><li class="chapter-item expanded "><a href="memory-management.html"><strong aria-hidden="true">7.</strong> Memory Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="memory-management/logical-physical.html"><strong aria-hidden="true">7.1.</strong> Logical vs. Physical Address Space</a></li><li class="chapter-item expanded "><a href="memory-management/allocation-and-protection.html"><strong aria-hidden="true">7.2.</strong> Allocation and Protection</a></li><li class="chapter-item expanded "><a href="memory-management/virtual-memory.html"><strong aria-hidden="true">7.3.</strong> Virtual Memory with Paging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="memory-management/virtual-memory/paging.html"><strong aria-hidden="true">7.3.1.</strong> Paging</a></li><li class="chapter-item expanded "><a href="memory-management/virtual-memory/segmentation.html"><strong aria-hidden="true">7.3.2.</strong> Segmentation</a></li></ol></li><li class="chapter-item expanded "><a href="memory-management/linux.html"><strong aria-hidden="true">7.4.</strong> Linux Virtual Memory</a></li><li class="chapter-item expanded "><a href="memory-management/demand-paging.html"><strong aria-hidden="true">7.5.</strong> Demand Paging</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="memory-management/demand-paging/cow-mmap.html"><strong aria-hidden="true">7.5.1.</strong> Copy-on-Write (COW) and Memory Mapped Files</a></li><li class="chapter-item expanded "><a href="memory-management/demand-paging/page-replacement.html"><strong aria-hidden="true">7.5.2.</strong> Page Replacement</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="device-management.html"><strong aria-hidden="true">8.</strong> Device Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="device-management/io-layering.html"><strong aria-hidden="true">8.1.</strong> I/O Layering</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="device-management/io-layering/interrupt-handler.html"><strong aria-hidden="true">8.1.1.</strong> Interrupt Handler Layer</a></li><li class="chapter-item expanded "><a href="device-management/io-layering/device-driver.html"><strong aria-hidden="true">8.1.2.</strong> Device Driver Layer</a></li><li class="chapter-item expanded "><a href="device-management/io-layering/device-independent-os-software.html"><strong aria-hidden="true">8.1.3.</strong> Device Independent OS Software Layer</a></li><li class="chapter-item expanded "><a href="device-management/io-layering/user-level-io-interface.html"><strong aria-hidden="true">8.1.4.</strong> User-Level I/O Interface Layer</a></li></ol></li><li class="chapter-item expanded "><a href="device-management/device-drivers.html"><strong aria-hidden="true">8.2.</strong> Device Drivers</a></li><li class="chapter-item expanded "><a href="device-management/blocking-vs-non-blocking-io.html"><strong aria-hidden="true">8.3.</strong> Blocking vs. Non-Blocking I/O</a></li><li class="chapter-item expanded "><a href="device-management/linux-io-api.html"><strong aria-hidden="true">8.4.</strong> Linux I/O API</a></li></ol></li><li class="chapter-item expanded "><a href="disk-management.html" class="active"><strong aria-hidden="true">9.</strong> Disk Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="disk-management/disk-scheduling.html"><strong aria-hidden="true">9.1.</strong> Disk Scheduling</a></li><li class="chapter-item expanded "><a href="disk-management/raid.html"><strong aria-hidden="true">9.2.</strong> RAID</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Operating Systems</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="disk-management"><a class="header" href="#disk-management">Disk Management</a></h1>
<h2 id="disk-evolution"><a class="header" href="#disk-evolution">Disk Evolution</a></h2>
<p><img src="images/disk-evolution.png" alt="Image" /></p>
<p><img src="images/disk-evolution-2.png" alt="Image" /></p>
<p>Over time disk capacity has increased exponentially, but access speeds haven't. This is due to magnetic disks having mechanical parts, meaning increasing the access speeds to disks is much more challenging as they are by both engineering and physcial limitations.</p>
<h2 id="what-is-driving-demand"><a class="header" href="#what-is-driving-demand">What is driving demand?</a></h2>
<p><img src="images/youtube-upload-rate.png" alt="Image" /></p>
<p>Large volumes of data are being generated, and they require an ever increasing amount of storage. The diagram above is an example which shows that YouTube is generating data at an exponential rate, so only an exponential increase in storage capacity is able to meet these demands.</p>
<h2 id="disk-storage-devices"><a class="header" href="#disk-storage-devices">Disk Storage Devices</a></h2>
<p><img src="images/disk-storage-devices.png" alt="Image" /></p>
<p>This diagram shows the general organisation of a disk. Each platter is subdivided into tracks, and the tracks are further subdivided into sectors. These sectors on the disk are the actual areas that store the data. A disk may contain multiple platters, with each platter having two surfaces. Platters are stacked up on a spindle and a read / write head is able to move across all of the different surfaces that exist simulaneously.</p>
<h3 id="tracks-and-cylinders"><a class="header" href="#tracks-and-cylinders">Tracks and Cylinders</a></h3>
<p><img src="images/tracks-and-cylinders.png" alt="Image" /></p>
<p>All tracks that are on top of each other (e.g. the shaded tracks on the platters in the diagram above) can be read from simulaneously by the read / write head. This works by the platters spinning, and when the read write head is over a particular track it can read all of the information that is stored on that track. Since this happens to all of the tracks that are on top of each other, this multi-layered track is refered to as a cylinder (a cylinder is essentially the unit of information that can be read from or written to in a single operation).</p>
<h3 id="sample-disk-specification"><a class="header" href="#sample-disk-specification">Sample Disk Specification</a></h3>
<pre><code>
  *------------*-------------*-------------*
  | Parameter  | IBM 360KB   | Seagate     |
  |            | Floppy Disk | Barracuda   |
  |            |             | ST 400832AS |
  *------------*-------------*-------------*
  | No. of     | 40          | 16,383      |
  | cylinders  |             |             |
  *------------*-------------*-------------*
  | Tracks per | 2           | 16          |
  | cylinder   |             |             |
  *------------*-------------*-------------*
  | Sectors    | 9           | 63          |
  | per track  |             |             |
  *------------*-------------*-------------*
  | Bytes per  | 512         | 512         |
  | sector     |             |             |
  *------------*-------------*-------------*
  | Sectors    | 720         | 781,422,768 |
  | per disk   |             |             |
  *------------*-------------*-------------*
  | Disk       | 360KB       | 400GB       |
  | capacity   |             |             |
  *------------*-------------*-------------*

</code></pre>
<h3 id="future-of-hdds-hamr"><a class="header" href="#future-of-hdds-hamr">Future of HDDs: HAMR</a></h3>
<p>Heat Assisted Magnetic Recording (HAMR) is a technique that allows for information to be stored in a more compact part of the platter surface, increasing the potential capacity. By heating up the medium before storing the bit, it allows for a more precise write.</p>
<p>HAMR can reach a density of 1.5 Tb per squared inch.</p>
<h3 id="sector-layout"><a class="header" href="#sector-layout">Sector Layout</a></h3>
<p><img src="./images/sector-layout.png" alt="Image" /></p>
<p>Because of the concentric shape of the of the sectors, depending on where the sector is the capacity may vary. This is an issue as there would not be a uniform storage density across the platter's surface if the number of sectors per track is kept constant. To solve this, disks usually distinguish between a virtual geometry and a physcial geometry.</p>
<p>The virtual geometry looks like regular concentric sectors on a disk, with a fixed number of sectors per track. On the other hand, the physcial geometry may actually be diffent. In the example above, there are more sectors per track in the outer zones compared with the inner zones. This is to account for the different sizes in sectors due to their location on the disc.</p>
<p>The physcial geometry is hidden from the software by remapping the data in a way that it seems like it is laid out in the virtual layout.</p>
<p>Platter surfaces can be divided into 20 or more zones.</p>
<h3 id="disk-addressing"><a class="header" href="#disk-addressing">Disk Addressing</a></h3>
<p>It used to be the case that the geometry was actually exposed to the OS. The OS would then refer to a particular cylinder number, a suface, and then a sector. This would uniquely select 512 bytes of information (assuming this is the sector size).</p>
<p>Modern discs use <strong>LBA</strong> (logical block / sector addressing) instead. In LBA, sectors are numbered from 0 to n. Using this, any sector can be directly refered to by its sector number. This helps make disk management much easier, and it helps to work around BIOS limitations.</p>
<h3 id="disk-formatting"><a class="header" href="#disk-formatting">Disk Formatting</a></h3>
<p>Before a disk can be used, it has to be formatted. Formatting is the process of imposing some structure onto the disk. There are two levels of format:</p>
<ul>
<li><strong>Low level format</strong>: ensures there is enough structure on a disc such that sectors can be read from reliably.
<ul>
<li>A low level format will impose a sector structure, where each sector:
<ul>
<li>starts with a preamble to indicate that it is a the start of a new sector.</li>
<li>has 512 bytes of data.</li>
<li>has an error correcting code at the end which is used to detect if the data has been corrupted due to any physical errors on the disk's surface.</li>
</ul>
</li>
<li>cylinder skew and interleaving were also imposed by low level formatting in the past. These are for the physical geometry of the disk, given a desired logical geometry.</li>
<li>Usually done by the manufacturer.</li>
</ul>
</li>
<li><strong>High level format</strong>: this is done when adding file systems or partitions to the disk. It includes:
<ul>
<li>the boot block.</li>
<li>free block list.</li>
<li>root directory.</li>
<li>the empty file system.</li>
</ul>
</li>
</ul>
<p>There is more information about high level formatting in the file systems chapter.</p>
<h3 id="disk-delays"><a class="header" href="#disk-delays">Disk Delays</a></h3>
<p><img src="images/disk-delays.png" alt="Image" /></p>
<p>Hard disks are relatively slow I/O devices. This is due to them having moving mechanics inside them. The speed of these mechanics determines the time it takes to retrieve data from the disk.</p>
<p>There are a few contributors to the overall delay:</p>
<ul>
<li><strong>Seek time</strong>: the time taken for the read / write head to physically move over the disk's surface.</li>
<li><strong>Latency time</strong>: the time taken for the disk to rotate such that the desired sectors are under the read / write head.</li>
<li><strong>Transfer time</strong>: the time taken for the disk to rotate through all of the desired sectors.</li>
</ul>
<h4 id="disk-performance"><a class="header" href="#disk-performance">Disk Performance</a></h4>
<p>A typical disk has:</p>
<ul>
<li>Sector size: 512 bytes.</li>
<li>Seek time (between adjacent cylinders / tracks): &lt; 1ms.</li>
<li>Seek time (average): 8ms.</li>
<li>Rotation time (Average latency): 4ms.</li>
<li>Transer rate: upwards of 100MB per sec.</li>
</ul>
<p>Given:</p>
<ul>
<li><code>b</code>: the number of bytes to be transferred.</li>
<li><code>N</code>: the number of bytes per track.</li>
<li><code>r</code>: the rotation speed in revolutions per second.</li>
</ul>
<p>let:</p>
<ul>
<li>Latency time (rotational delay): <code>1 / 2r</code></li>
<li>Transfer time: <code>b / rN</code></li>
</ul>
<p>Thus the total access time is given by <code>seek time + 1 / 2r + b / rN</code></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="device-management/linux-io-api.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="disk-management/disk-scheduling.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="device-management/linux-io-api.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="disk-management/disk-scheduling.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
